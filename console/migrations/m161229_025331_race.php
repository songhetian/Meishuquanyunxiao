<?php

use yii\db\Migration;

class m161229_025331_race extends Migration
{
    const TBL_NAME = '{{%race}}';

    /**
     * 创建表选项
     * @var string
     */
    public $tableOptions = null;

    /**
     * 是否创建为事务表
     * @var bool
     */
    public $useTransaction = true;
    
    public function safeUp()
    {
        if ($this->db->driverName === 'mysql') {
            $engine = $this->useTransaction ? 'InnoDB' : 'MyISAM';
            $this->tableOptions = 'CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci ENGINE=' . $engine;
        }

        $this->execute($this->delTable());
        $this->createTable(self::TBL_NAME, [
            'id' => $this->primaryKey()->unsigned()->comment('ID'),  
            'name' => $this->string(20)->notNull()->comment('名称'),
            
            'created_at' => $this->integer()->notNull()->comment('创建时间'),
            'updated_at' => $this->integer()->notNull()->comment('更新时间'),
            'status' => $this->smallInteger()->notNull()->defaultValue(10)->comment('状态'),
        ], $this->tableOptions);
        $this->execute($this->getRaceSql());
    }

    private function delTable()
    {
        return "DROP TABLE IF EXISTS ".self::TBL_NAME.";";
    }

    public function safeDown()
    {
        $this->dropTable(self::TBL_NAME);
    }

    private function getRaceSql()
    {
        return "INSERT INTO `race` (`id`, `name`, `created_at`, `updated_at`, `status`) VALUES
        (1, '汉族', 1463987935, 1463987935, 10),
        (2, '壮族', 1463987935, 1463987935, 10),
        (3, '回族', 1463987935, 1463987935, 10),
        (4, '满族', 1463987935, 1463987935, 10),
        (5, '维吾尔族', 1463987935, 1463987935, 10),
        (6, '苗族', 1463987935, 1463987935, 10),
        (7, '彝族', 1463987935, 1463987935, 10),
        (8, '土家族', 1463987935, 1463987935, 10),
        (9, '藏族', 1463987935, 1463987935, 10),
        (10, '蒙古族', 1463987935, 1463987935, 10),
        (11, '侗族', 1463987935, 1463987935, 10),
        (12, '布依族', 1463987935, 1463987935, 10),
        (13, '瑶族', 1463987935, 1463987935, 10),
        (14, '白族', 1463987935, 1463987935, 10),
        (15, '朝鲜族', 1463987935, 1463987935, 10),
        (16, '哈尼族', 1463987935, 1463987935, 10),
        (17, '黎族', 1463987935, 1463987935, 10),
        (18, '哈萨克族', 1463987935, 1463987935, 10),
        (19, '傣族', 1463987935, 1463987935, 10),
        (20, '畲族', 1463987935, 1463987935, 10),
        (21, '傈僳族', 1463987935, 1463987935, 10),
        (22, '东乡族', 1463987935, 1463987935, 10),
        (23, '仡佬族', 1463987935, 1463987935, 10),
        (24, '拉祜族', 1463987935, 1463987935, 10),
        (25, '佤族', 1463987935, 1463987935, 10),
        (26, '水族', 1463987935, 1463987935, 10),
        (27, '纳西族', 1463987935, 1463987935, 10),
        (28, '羌族', 1463987935, 1463987935, 10),
        (29, '土族', 1463987935, 1463987935, 10),
        (30, '仫佬族', 1463987935, 1463987935, 10),
        (31, '锡伯族', 1463987935, 1463987935, 10),
        (32, '柯尔克孜族', 1463987935, 1463987935, 10),
        (33, '景颇族', 1463987935, 1463987935, 10),
        (34, '达斡尔族', 1463987935, 1463987935, 10),
        (35, '撒拉族', 1463987935, 1463987935, 10),
        (36, '布朗族', 1463987935, 1463987935, 10),
        (37, '毛南族', 1463987935, 1463987935, 10),
        (38, '塔吉克族', 1463987935, 1463987935, 10),
        (39, '普米族', 1463987935, 1463987935, 10),
        (40, '阿昌族', 1463987935, 1463987935, 10),
        (41, '怒族', 1463987935, 1463987935, 10),
        (42, '鄂温克族', 1463987935, 1463987935, 10),
        (43, '京族', 1463987935, 1463987935, 10),
        (44, '基诺族', 1463987935, 1463987935, 10),
        (45, '德昂族', 1463987935, 1463987935, 10),
        (46, '保安族', 1463987935, 1463987935, 10),
        (47, '俄罗斯族', 1463987935, 1463987935, 10),
        (48, '裕固族', 1463987935, 1463987935, 10),
        (49, '乌孜别克族', 1463987935, 1463987935, 10),
        (50, '门巴族', 1463987935, 1463987935, 10),
        (51, '鄂伦春族', 1463987935, 1463987935, 10),
        (52, '独龙族', 1463987935, 1463987935, 10),
        (53, '赫哲族', 1463987935, 1463987935, 10),
        (54, '高山族', 1463987935, 1463987935, 10),
        (55, '珞巴族', 1463987935, 1463987935, 10),
        (56, '塔塔尔族', 1463987935, 1463987935, 10);";
    }
}